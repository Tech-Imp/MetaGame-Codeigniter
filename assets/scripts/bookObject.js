// Generated by CoffeeScript 1.7.1
(function() {
  var bookObject,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  bookObject = (function() {
    bookObject.prototype.debug = true;

    function bookObject(uid, name, author, pages, price, stock, wish, img) {
      this.uid = uid;
      this.name = name;
      this.author = author;
      this.pages = pages;
      this.price = price;
      this.stock = stock;
      this.wish = wish;
      this.img = img != null ? img : "../assets/image/genericBook.jpg";
      this.updateWishlist = __bind(this.updateWishlist, this);
      this.addToWish = __bind(this.addToWish, this);
      this.addToCart = __bind(this.addToCart, this);
      this.populateInspect = __bind(this.populateInspect, this);
      this.addToRoster = __bind(this.addToRoster, this);
      if (this.debug) {
        console.log("bookIndex.constructor");
      }
      this.addToRoster();
    }

    bookObject.prototype.addToRoster = function() {
      var inWish, isAvail, wishFlag;
      if (this.debug) {
        console.log("bookIndex.addToRoster");
      }
      if (this.stock > 0) {
        isAvail = "In Stock";
      } else {
        isAvail = "Out of Stock";
      }
      wishFlag = "";
      inWish = "";
      if (this.wish) {
        wishFlag = "wishColor";
        inWish = ", In Wishlist";
      }
      $("#bookDatabase").append("<div id=\"" + this.uid + "\" class=\"col-lg-2 col-md-4 col-xs-12 well " + wishFlag + "\">\n     <div><strong>" + this.name + ", by " + this.author + "</strong></div>\n     <img class='visible-lg-block' src='" + this.img + "' width='98%'>\n     <div>" + isAvail + inWish + "</div>\n     <div>\n          <button type=\"button\" class=\"btn btn-info inspect\">\n               <span class=\"glyphicon glyphicon-eye-open\"></span>\n          </button>\n          <button type=\"button\" class=\"btn btn-success wishAdd\">\n               <span class=\"glyphicon glyphicon-star\"></span>\n          </button>\n          <button type=\"button\" class=\"btn btn-primary cartBuy\">\n               <span class=\"glyphicon glyphicon-shopping-cart\"></span>\n          </button>\n     </div>\n</div>");
      $("#" + this.uid + " .inspect").unbind().bind("click", (function(_this) {
        return function(event) {
          console.log("clicked" + _this.uid);
          return _this.populateInspect();
        };
      })(this));
      $("#" + this.uid + " .cartBuy").unbind().bind("click", (function(_this) {
        return function(event) {
          return _this.addToCart();
        };
      })(this));
      return $("#" + this.uid + " .wishAdd").unbind().bind("click", (function(_this) {
        return function(event) {
          return _this.addToWish();
        };
      })(this));
    };

    bookObject.prototype.populateInspect = function() {
      if (this.debug) {
        console.log("bookIndex.populateInspect");
      }
      $("#bookTitle").html(this.name);
      $("#bookAuthor").html(this.author);
      $("#bookPages").html(this.pages);
      $("#bookPrice").html(this.price);
      if (this.stock > 0) {
        $("#bookStock").html(this.stock);
      } else {
        $("#bookStock").html("Out of Stock");
      }
      if (this.wish) {
        $("#bookWish").html("In Wishlist");
      } else {
        $("#bookWish").html("");
      }
      $("#bookModalImg").attr("src", this.img);
      return $("#bookReviewModal").modal("show");
    };

    bookObject.prototype.addToCart = function() {
      if (this.debug) {
        return console.log("bookIndex.addToCart");
      }
    };

    bookObject.prototype.addToWish = function() {
      if (this.debug) {
        console.log("bookIndex.addToWish");
      }
      return $.ajax({
        url: "post/addToWishlist",
        type: 'post',
        dataType: 'json',
        data: {
          uid: this.uid,
          title: this.name,
          author: this.author
        },
        success: (function(_this) {
          return function(response) {
            if (response.success) {
              return _this.updateWishlist();
            }
          };
        })(this)
      });
    };

    bookObject.prototype.updateWishlist = function() {
      if (this.debug) {
        return console.log("bookIndex.updateWishlist");
      }
    };

    return bookObject;

  })();

  if (window.classes == null) {
    window.classes = {};
  }

  window.classes.bookObject = bookObject;

}).call(this);
